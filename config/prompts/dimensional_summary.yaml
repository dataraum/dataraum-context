# Dimensional Entropy Executive Summary Prompt
#
# Synthesizes dimensional entropy analysis results into a concise
# executive summary with refined quality concerns and recommendations.
# Uses tool-based output for structured responses.

name: dimensional_summary
version: "1.0.0"
description: Generate executive summary for dimensional entropy analysis of a dataset

# Temperature (0.0 = deterministic, 1.0 = creative)
temperature: 0.1

# System prompt - defines role and behavior
system_prompt: |
  <role>
  You are a data analyst specializing in dimensional data quality assessment.
  Your task is to synthesize dimensional entropy analysis results into a concise,
  actionable executive summary for data engineers and business analysts.
  </role>

  <guidelines>
  - Write the executive summary in clear, professional prose (3-5 sentences)
  - Lead with the most important finding
  - Quantify claims using actual numbers from the data
  - Distinguish between concerns requiring immediate action vs. monitoring
  - For quality concerns, explain the business impact
  - For recommendations, be specific and actionable with clear next steps
  - Do not repeat the same information across summary, concerns, and recommendations
  </guidelines>

  Use the summarize_dimensional_entropy tool to provide your structured response.

# User prompt - provides analysis data
user_prompt: |
  <task>
  Analyze the dimensional entropy findings for this dataset and provide:
  1. A concise executive summary (3-5 sentences of prose)
  2. Refined data quality concerns with business impact
  3. Prioritized, actionable recommendations
  </task>

  <dataset_context>
  Table: {table_name}
  Slice Column: {slice_column}
  Total Columns: {total_columns}
  </dataset_context>

  <column_breakdown>
  Interesting Categorical: {interesting_categorical_columns}
  Interesting Temporal: {interesting_temporal_columns}
  Stable: {stable_columns}
  Empty: {empty_columns}
  Constant: {constant_columns}
  </column_breakdown>

  <entropy_scores>
  Dimensional Entropy Score: {dimensional_entropy_score}
  Categorical Entropy: {categorical_entropy}
  Temporal Entropy: {temporal_entropy}
  Uncertainty Bits: {uncertainty_bits}
  Complexity Level: {complexity_level}
  </entropy_scores>

  <pattern_counts>
  Mutual Exclusivity: {mutual_exclusivity_patterns}
  Conditional Dependency: {conditional_dependency_patterns}
  Correlated Variance: {correlated_variance_patterns}
  Temporal Correlation: {temporal_correlation_patterns}
  Temporal Drift: {temporal_drift_patterns}
  </pattern_counts>

  <interesting_columns>
  {interesting_columns_json}
  </interesting_columns>

  <business_rules>
  {business_rules_json}
  </business_rules>

  <column_quality_findings>
  This section contains LLM-generated quality assessments per column, aggregated
  across all slices. Each entry includes the average quality score (0-1), entropy
  score (1 - quality), quality grades (A-F), key findings, quality issues, and
  recommendations from the detailed per-column analysis.
  {column_quality_findings_json}
  </column_quality_findings>

  <current_concerns>
  {data_quality_concerns_json}
  </current_concerns>

  <current_recommendations>
  {current_recommendations_json}
  </current_recommendations>

  Use the summarize_dimensional_entropy tool to provide your structured response.

# Input variable definitions
inputs:
  table_name:
    description: Name of the analyzed table
    required: true

  slice_column:
    description: Name of the slice column
    required: false
    default: "none"

  total_columns:
    description: Total number of columns analyzed
    required: true

  interesting_categorical_columns:
    description: Count of interesting categorical columns
    required: true

  interesting_temporal_columns:
    description: Count of interesting temporal columns
    required: true

  stable_columns:
    description: Count of stable columns
    required: true

  empty_columns:
    description: Count of empty columns
    required: true

  constant_columns:
    description: Count of constant columns
    required: true

  dimensional_entropy_score:
    description: Overall dimensional entropy score (0.0-1.0)
    required: true

  categorical_entropy:
    description: Categorical entropy score
    required: true

  temporal_entropy:
    description: Temporal entropy score
    required: true

  uncertainty_bits:
    description: Total uncertainty in bits
    required: true

  complexity_level:
    description: Assessed complexity level (low, moderate, high, very_high)
    required: true

  mutual_exclusivity_patterns:
    description: Count of mutual exclusivity patterns
    required: false
    default: "0"

  conditional_dependency_patterns:
    description: Count of conditional dependency patterns
    required: false
    default: "0"

  correlated_variance_patterns:
    description: Count of correlated variance patterns
    required: false
    default: "0"

  temporal_correlation_patterns:
    description: Count of temporal correlation patterns
    required: false
    default: "0"

  temporal_drift_patterns:
    description: Count of temporal drift patterns
    required: false
    default: "0"

  interesting_columns_json:
    description: JSON array of interesting column details with reasons and metrics
    required: true

  business_rules_json:
    description: JSON array of detected business rules with confidence and descriptions
    required: true

  column_quality_findings_json:
    description: JSON array of LLM-generated column quality findings aggregated across slices, including quality scores, grades, key findings, issues, and recommendations
    required: false
    default: "[]"

  data_quality_concerns_json:
    description: JSON array of current quality concerns (from hardcoded analysis)
    required: false
    default: "[]"

  current_recommendations_json:
    description: JSON array of current recommendations (from hardcoded analysis)
    required: false
    default: "[]"
