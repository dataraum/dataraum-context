# Financial Domain Formatter Thresholds
# =====================================
#
# Stricter thresholds for financial/accounting data.
# These override defaults.yaml for the financial domain.
#
# Key differences from defaults:
# - Lower tolerance for nulls (financial data should be complete)
# - Stricter outlier detection (unusual amounts need investigation)
# - Benford's Law is critical (fraud detection)
# - Shorter staleness tolerance (financial data should be current)
# - Balance-related metrics added

domain: financial

groups:
  # ============================================================================
  # Completeness Group - Stricter for financial data
  # ============================================================================
  completeness:
    metrics:
      null_ratio:
        thresholds:
          none: 0.001     # <0.1% nulls (much stricter)
          low: 0.01       # 0.1-1% is low concern
          moderate: 0.05  # 1-5% needs attention
          high: 0.1       # 5-10% is problematic
        default_severity: severe  # >10% is severe

      completeness_ratio:
        thresholds:
          none: 0.999     # >99.9% complete (much stricter)
          low: 0.99       # 99-99.9% is low concern
          moderate: 0.95  # 95-99% needs attention
          high: 0.8       # 80-95% is problematic
        default_severity: severe
        ascending: false

    column_patterns:
      # Financial IDs should NEVER be null
      "*_id":
        null_ratio:
          thresholds:
            none: 0.0
          default_severity: critical

      # Account numbers are critical
      "*account*":
        null_ratio:
          thresholds:
            none: 0.0
          default_severity: critical

      # Amounts should rarely be null
      "*amount*":
        null_ratio:
          thresholds:
            none: 0.001
            low: 0.005
          default_severity: severe

      # Dates are critical for financial records
      "*date*":
        null_ratio:
          thresholds:
            none: 0.0
          default_severity: critical

  # ============================================================================
  # Outliers Group - Tighter for financial data
  # ============================================================================
  outliers:
    metrics:
      iqr_outlier_ratio:
        thresholds:
          none: 0.005     # <0.5% outliers (stricter)
          low: 0.02       # 0.5-2% is low concern
          moderate: 0.05  # 2-5% needs attention
          high: 0.1       # 5-10% is problematic
        default_severity: severe

      isolation_forest_ratio:
        thresholds:
          none: 0.005
          low: 0.02
          moderate: 0.05
          high: 0.1
        default_severity: severe

  # ============================================================================
  # Benford Group - Critical for financial fraud detection
  # ============================================================================
  benford:
    metrics:
      p_value:
        thresholds:
          none: 0.05      # Stricter: p > 0.05 is acceptable
          low: 0.01       # 0.01-0.05 = borderline
          moderate: 0.001 # 0.001-0.01 = likely violation
        default_severity: critical  # p < 0.001 = critical (potential fraud)
        ascending: false

  # ============================================================================
  # Temporal Group - Financial data should be current
  # ============================================================================
  temporal:
    metrics:
      staleness_days:
        thresholds:
          none: 1         # Daily updates expected
          low: 3          # 1-3 days is acceptable
          moderate: 7     # 3-7 days needs attention
          high: 30        # 1 week - 1 month is problematic
        default_severity: severe

      gap_count:
        thresholds:
          none: 0         # No gaps for financial data
          low: 1          # 1 gap is concerning
          moderate: 2     # 2 gaps needs immediate attention
        default_severity: severe

      temporal_completeness:
        thresholds:
          none: 0.999     # >99.9% coverage required
          low: 0.99       # 99-99.9% is acceptable
          moderate: 0.95  # 95-99% needs attention
          high: 0.9       # 90-95% is problematic
        default_severity: severe
        ascending: false

      largest_gap_days:
        thresholds:
          none: 0         # No gaps expected in daily data
          low: 1          # 1 day gap is concerning for financial
          moderate: 3     # 2-3 days needs attention
          high: 7         # Week-long gap is problematic
        default_severity: severe

  # ============================================================================
  # Domain Quality Group - Financial-specific
  # ============================================================================
  domain:
    metrics:
      compliance_score:
        thresholds:
          none: 0.999     # >99.9% compliance required
          low: 0.99       # 99-99.9% is acceptable
          moderate: 0.95  # 95-99% needs attention
        default_severity: critical  # <95% is critical
        ascending: false

      violation_count:
        thresholds:
          none: 0         # No violations allowed
          low: 1          # 1 violation needs review
        default_severity: critical  # >1 violation is critical

      # Financial-specific: balance tolerance
      balance_difference:
        thresholds:
          none: 0.01      # <1 cent difference
          low: 1.0        # 1 cent - 1 dollar
          moderate: 100.0 # 1-100 dollars
        default_severity: critical  # >100 dollar imbalance is critical

      # Sign convention compliance
      sign_compliance:
        thresholds:
          none: 1.0       # 100% compliance required
          low: 0.99       # 99-100% is acceptable
        default_severity: critical
        ascending: false
