# DEPRECATED: This file is deprecated.
# Rules have been migrated to config/graphs/filters/rules/ as graph-based filters.
#
# See:
#   - config/graphs/filters/rules/role_based.yaml
#   - config/graphs/filters/rules/type_based.yaml
#   - config/graphs/filters/rules/pattern_based.yaml
#   - config/graphs/filters/rules/consistency.yaml
#
# This file is kept for backward compatibility during the migration period.
#
# ---
# Original documentation:
# Default Quality Rules Configuration
#
# Rules are auto-applied based on detected column types and patterns.
# Additional rules can be defined per ontology.

name: default
version: "1.0.0"
description: Standard quality rules for common data patterns

# Rules applied based on detected semantic role
role_based_rules:
  key:
    - rule: not_null
      severity: error
      description: Key columns must not contain null values
      
    - rule: unique
      severity: error
      description: Key columns must contain unique values
      
  timestamp:
    - rule: not_null
      severity: warning
      description: Timestamp columns should not contain nulls
      
    - rule: valid_date_range
      parameters:
        min: "1970-01-01"
        max: "2100-01-01"
      severity: warning
      description: Timestamps should be within reasonable range
      
  measure:
    - rule: numeric_type
      severity: error
      description: Measure columns must be numeric
      
  foreign_key:
    - rule: referential_integrity
      severity: error
      description: Foreign keys must reference existing values

# Rules applied based on detected data type
type_based_rules:
  DOUBLE:
    - rule: not_nan
      severity: warning
      description: Floating point columns should not contain NaN
      
    - rule: not_inf
      severity: warning
      description: Floating point columns should not contain infinity
      
  DATE:
    - rule: valid_date
      severity: error
      description: Date values must be parseable
      
  TIMESTAMP:
    - rule: valid_timestamp
      severity: error
      description: Timestamp values must be parseable
      
  VARCHAR:
    - rule: max_length
      parameters:
        max: 10000
      severity: warning
      description: String values should not exceed reasonable length

# Rules applied based on column name patterns
pattern_based_rules:
  - pattern: '.*_email$|^email$'
    rules:
      - rule: valid_email
        severity: warning
        description: Email columns should contain valid email addresses
        
  - pattern: '.*_url$|^url$'
    rules:
      - rule: valid_url
        severity: warning
        description: URL columns should contain valid URLs
        
  - pattern: '.*_phone.*|^phone$'
    rules:
      - rule: valid_phone
        severity: warning
        description: Phone columns should contain valid phone numbers

# Statistical rules (auto-generated from profiling)
statistical_rules:
  - rule: outlier_detection
    parameters:
      method: zscore
      threshold: 3.0
    applies_to: numeric
    severity: info
    description: Flag values more than 3 standard deviations from mean
    
  - rule: cardinality_check
    parameters:
      warn_if_unique_ratio_below: 0.001
      warn_if_unique_ratio_above: 0.999
    applies_to: all
    severity: info
    description: Flag columns with suspicious cardinality
    
  - rule: null_rate_threshold
    parameters:
      warning_threshold: 0.1
      error_threshold: 0.5
    applies_to: all
    severity: warning
    description: Flag columns with high null rates

# Consistency rules (cross-column)
consistency_rules:
  - rule: date_order
    description: Start date should be before end date
    pattern:
      start_column: '.*_start.*|^start_.*'
      end_column: '.*_end.*|^end_.*'
    expression: "{start_column} <= {end_column}"
    severity: error
    
  - rule: amount_sign
    description: Related amount columns should have consistent signs
    pattern:
      debit_column: '.*debit.*'
      credit_column: '.*credit.*'
    expression: "NOT ({debit_column} > 0 AND {credit_column} > 0)"
    severity: warning

# Custom rule templates
custom_rule_templates:
  range_check:
    description: Value should be within specified range
    parameters:
      - name: min
        type: numeric
        required: false
      - name: max
        type: numeric
        required: false
    expression: "({column} >= {min} OR {min} IS NULL) AND ({column} <= {max} OR {max} IS NULL)"
    
  enum_check:
    description: Value should be one of allowed values
    parameters:
      - name: allowed_values
        type: list
        required: true
    expression: "{column} IN ({allowed_values})"
    
  regex_check:
    description: Value should match regex pattern
    parameters:
      - name: pattern
        type: string
        required: true
    expression: "regexp_matches({column}, '{pattern}')"
